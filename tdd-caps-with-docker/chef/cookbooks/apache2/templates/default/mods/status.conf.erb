<IfModule mod_status.c>
  #
  # Allow server status reports generated by mod_status,
  # with the URL of http://servername/server-status
  # Uncomment and change the ".example.com" to allow
  # access from other hosts.
  #
  <Location /server-status>
    SetHandler server-status
<% if node['apache']['version'] == '2.4' -%>
    Require local
    Require ip <%=node['apache']['status_allow_list']%>
<% else -%>
    Order deny,allow
    Deny from all
    Allow from <%= node['apache']['status_allow_list'] %>
 <% end -%>
  </Location>

  #
  # ExtendedStatus controls whether Apache will generate "full" status
  # information (ExtendedStatus On) or just basic information (ExtendedStatus
  # Off) when the "server-status" handler is called. The default is Off.
  #
  <% if node['apache']['ext_status'] -%>
  ExtendedStatus On
  <% else -%>
  ExtendedStatus Off
  <% end -%>

<% if node['apache']['version'] == '2.4' -%>
  # Determine if mod_status displays the first 63 characters of a request or
  # the last 63, assuming the request itself is greater than 63 chars.
  # Default: Off
  #SeeRequestTail On

  <IfModule mod_proxy.c>
     # Show Proxy LoadBalancer status in mod_status
     ProxyStatus On
  </IfModule>
<% end -%>
</IfModule>
